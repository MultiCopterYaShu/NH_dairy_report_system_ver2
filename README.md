# 日報管理システム

Python Flask + バニラJavaScriptで構築された、シンプルで使いやすい日報管理システムです。
スマートフォン、タブレット、PCに対応したレスポンシブデザインで、どこからでも日報を記録できます。

## 主な機能

### 📝 日報管理
- **日報入力**: 日付を選択して、作業項目を動的に追加
- **階層的な作業項目選択**: 最大4階層の作業項目から選択可能
- **工数管理**: サイクルタイム属性の作業では、目標工数と実績工数を記録
- **チェックリスト**: 作業項目ごとにチェックリストを設定可能
- **プロジェクト紐付け**: 作業項目をプロジェクトに関連付け
- **編集・削除**: 過去の日報を簡単に編集・削除
- **達成アニメーション**: 日報完了時に達成感のあるアニメーション表示

### 👥 ユーザー管理
- **ログイン認証**: セキュアなログイン機能
- **役割管理**: 管理者（admin）と一般ユーザー（user）
- **担当種別**: ユーザーごとに担当種別を設定し、表示する作業項目を自動絞り込み

### ⚙️ マスター管理（管理者のみ）
- **作業項目マスター**: 
  - 最大4階層の作業項目を作成
  - 属性設定（サイクルタイム / 時期）
  - 目標工数の設定（分単位）
  - チェックリストの動的追加
  - 社内/社外リードタイム管理
  - 担当種別による絞り込み
  
- **担当種別マスター**: 
  - 担当種別の追加・編集・削除
  - アカウントと作業項目の絞り込みに使用
  
- **プロジェクトマスター**: 
  - プロジェクトの管理
  - ステータス管理（未着手 / 実行中 / 完了）

### 🎨 レスポンシブデザイン
- スマートフォン最適化
- タブレット対応
- PC対応
- モダンでクリーンなUI/UX

## セットアップ

### 1. 仮想環境の作成と有効化
```bash
python3 -m venv .venv
source .venv/bin/activate  # macOS/Linux
# または
.venv\Scripts\activate  # Windows
```

### 2. 依存パッケージのインストール
```bash
pip install -r requirements.txt
```

### 3. アプリケーションの起動
```bash
# 方法1: Pythonで直接起動
python app.py

# 方法2: 起動スクリプトを使用（macOS/Linux）
./start.sh
```

### 4. ブラウザでアクセス
```
http://localhost:5000
```

## 初期ログイン情報

- **ユーザー名**: admin
- **パスワード**: admin123

⚠️ 初回ログイン後、セキュリティのため管理画面からパスワードを変更することをお勧めします。

## 使い方

### 日報の記録方法

1. **ログイン**
   - ユーザー名とパスワードを入力してログイン

2. **新規日報追加**
   - 「+ 新規日報追加」ボタンをクリック
   - 日付を選択（デフォルトは今日の日付）

3. **作業項目の選択**
   - ドロップダウンから階層的に作業項目を選択
   - 複数の作業項目を追加可能（「+ 作業項目追加」ボタン）

4. **詳細入力**
   - サイクルタイム属性の場合: 実績工数を入力（目標工数が表示されます）
   - チェックリストがある場合: 該当項目をチェック
   - プロジェクトを選択（任意）

5. **日報完了**
   - 「日報完了」ボタンをクリック
   - 達成アニメーションが表示され、履歴に追加されます

### 管理者機能

管理者でログインすると「管理」ボタンが表示されます。

#### アカウント管理
- 新規アカウントの追加
- 既存アカウントの編集（パスワード変更、権限変更、担当種別変更）
- アカウントの削除（adminアカウント以外）

#### 作業項目マスター
1. 「+ 作業項目追加」をクリック
2. 作業項目名を入力
3. 親項目を選択（階層構造を作成）
4. 属性を設定（最下層のみ）
   - サイクルタイム: 目標工数を分単位で設定
   - 時期: 時期ベースの作業
5. チェックリストを追加（1行1項目）
6. 担当種別を選択（複数選択可能）
7. リードタイム設定（社内/社外）
8. 「保存」をクリック

#### 担当種別マスター
- 「+ 担当種別追加」で新規追加
- 既存の担当種別を編集・削除

#### プロジェクトマスター
- 「+ プロジェクト追加」で新規追加
- プロジェクト名とステータスを設定
- ステータス: 未着手 / 実行中 / 完了

## データ管理

すべてのデータはJSON形式で `data/` ディレクトリに保存されます：

- `users.json`: ユーザーアカウント情報
- `work_items.json`: 作業項目マスター
- `job_categories.json`: 担当種別マスター
- `projects.json`: プロジェクトマスター
- `reports_[ユーザー名].json`: ユーザーごとの日報データ

## 技術スタック

- **バックエンド**: Python 3.9+, Flask 3.0
- **フロントエンド**: バニラJavaScript（フレームワークなし）
- **スタイリング**: CSS3（レスポンシブデザイン）
- **データ保存**: JSON形式のファイルベース
- **認証**: Flaskセッション + Werkzeugパスワードハッシュ

## ディレクトリ構造

```
日報管理ver2/
├── app.py                 # メインアプリケーション
├── requirements.txt       # Python依存パッケージ
├── start.sh              # 起動スクリプト
├── README.md             # このファイル
├── backend/              # バックエンドコード
│   ├── routes/          # APIルート
│   │   ├── auth.py      # 認証API
│   │   ├── accounts.py  # アカウント管理API
│   │   ├── masters.py   # マスター管理API
│   │   └── reports.py   # 日報API
│   └── utils/           # ユーティリティ
│       ├── json_manager.py  # JSON操作
│       └── init_data.py     # 初期データ作成
├── templates/            # HTMLテンプレート
│   └── index.html
├── static/              # 静的ファイル
│   ├── css/
│   │   └── style.css    # スタイル
│   └── js/
│       ├── api.js       # API通信
│       ├── auth.js      # 認証機能
│       ├── reports.js   # 日報機能
│       ├── admin.js     # 管理機能
│       └── app.js       # アプリ初期化
└── data/                # データ保存ディレクトリ
    └── *.json          # JSONデータファイル
```

## セキュリティに関する注意事項

- 本番環境では、`.env`ファイルを作成し、`SECRET_KEY`を設定してください
- HTTPSを使用することをお勧めします
- データベースではなくJSONファイルを使用しているため、大規模な運用には向いていません
- 定期的にバックアップを取ることをお勧めします

## ライセンス

このプロジェクトは個人利用・商用利用ともに自由にご利用いただけます。

## サポート

問題が発生した場合は、以下を確認してください：
1. Python 3.9以上がインストールされているか
2. 仮想環境が正しく有効化されているか
3. 必要なパッケージがすべてインストールされているか
4. ポート5000が他のアプリケーションで使用されていないか

